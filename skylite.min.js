/*!
skylite.js

(c) 2012-2013 Douglas Waltman II, DigitalAugment Inc.
Skylite may be freely distributed under the MIT license.

http://github.com/dw2/skylite
*/
(function(){window.Skylite=(function(){function a(b){var c,d,e,f=this;for(c in b){d=b[c];this[c]=d}this.$modal=$("<div class='modal active "+((e=this.type)!=null?e:"")+"'>");if(this.title!=null){$("<h1>"+this.title+"</h1>").appendTo(this.$modal)}if(this.body!=null){$("<p>"+this.body+"</p>").appendTo(this.$modal)}if(this.html!=null){$(this.html).appendTo(this.$modal)}this.$actions=$("<div class='actions'>");if(this.actions!=null){$.each(this.actions,function(h,g){return $("<button>").text(h).addClass(h.toLowerCase().replace(/[^a-z]/g,"")).click(function(){if(g(f)){return f.dismiss()}}).appendTo(f.$actions)})}else{$("<button>").text("Okay").addClass("ok").click(function(){return f.dismiss()}).appendTo(this.$actions)}setTimeout(function(){return $(document).on("keyup",function(h){var g;if(!f.$modal.is(":last-of-type")){return}c=(g=h.keyCode)!=null?g:h.which;if(c===13){f.$actions.find("button:last").trigger("click");$(document).off("keypress",false,f.keypress)}if(c===27){f.dismiss();return $(document).off("keypress",false,f.keypress)}},f.keypress)},500);this.$actions.appendTo(this.$modal);return this.render()}a.prototype.mask=function(){var b=this;if($(".wmd-prompt-background").length){$("#mask").remove()}else{if($("#mask").length===0){$("body").append('<div id="mask"></div>')}}this.$mask=$("#mask, .wmd-prompt-background");if(!$(".modal").length){this.$mask.stop(true).css({opacity:0}).animate({opacity:1},400,"linear")}return this.$mask.click(function(){if(!b.lockMask){return b.dismiss()}})};a.prototype.unmask=function(){if($("body > .modal").length>1){return}return $("#mask, .wmd-prompt-background").stop(true).fadeTo(200,0,function(){return $(this).remove()})};a.prototype.render=function(){var b;if(!this.hideMask){this.mask()}$(".modal").removeClass("active");if(this.cssIn!=null){this.$modal.css(this.cssIn)}this.$modal.appendTo("body");if(this.animIn!=null){this.$modal.animate(this.animIn[0],(b=this.animIn[1])!=null?b:400)}return this.$modal};a.prototype.dismiss=function(){var b,c,d=this;if($("body > .modal").length===1){this.unmask()}b=function(){var e,f;if(d.callback!=null){e=d.$modal;d.callback()}d.$modal.remove();f=$(".modal");if(f.length){return f.last().addClass("active")}else{return d.unmask()}};if(this.cssOut!=null){this.$modal.css(this.cssOut)}if(this.animOut!=null){return this.$modal.animate(this.animOut[0],(c=this.animOut[1])!=null?c:400,b)}else{return b()}};return a})()}).call(this);